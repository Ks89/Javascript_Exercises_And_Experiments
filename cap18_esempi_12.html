<!DOCTYPE html>
<!--
To change this license header, choose License Headers in Project Properties.
To change this template file, choose Tools | Templates
and open the template in the editor.
-->
<html>
    <head>
        <title>TODO supply a title</title>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
    </head>
    <body>


        Notes: <select id="list"></select>
        <button onclick="addNote()">new</button><br>
        <textarea id="currentnote" style="width: 100px; height: 10em">
        </textarea>

        <script>
            var list = document.querySelector("#list");
            function addToList(name) {
                var option = document.createElement("option");
                option.textContent = name;
                list.appendChild(option);
            }

            //init list from localstorage
            var notes = JSON.parse(localStorage.getItem("notes")) ||
                    {"shopping list": ""};

            for (var name in notes) {
                if(notes.hasOwnProperty(name)) {
                    addToList(name);
                }
            }

            function saveToStorage() {
                localStorage.setItem("notes", JSON.stringify(notes));
            }

            var current = document.querySelector("#currentnote");
            current.value = notes[list.value];

            list.addEventListener("change", function() {
                current.value = notes[list.value];
            });
            current.addEventListener("change", function() {
               notes[list.value] = current.value;
                saveToStorage();
            });

            function addNote() {
                var name = prompt("Note name", "");
                if(!name) return;
                if(!notes.hasOwnProperty(name)) {
                    notes[name] = "";
                    addToList(name);
                    saveToStorage();
                }

                list.value = name;
                current.value = notes[name];
            }



        </script>

        
    </body>
</html>
